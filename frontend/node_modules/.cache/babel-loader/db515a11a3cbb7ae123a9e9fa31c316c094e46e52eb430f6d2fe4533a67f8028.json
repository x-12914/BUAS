{"ast":null,"code":"import React,{useState,useMemo}from'react';import'./UserList.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserList=_ref=>{let{users=[],loading=false,onPlayAudio,onStartListening,onStopListening,selectedUser,onUserSelect}=_ref;const[searchTerm,setSearchTerm]=useState('');const[statusFilter,setStatusFilter]=useState('all');// Filter and search users\nconst filteredUsers=useMemo(()=>{let filtered=users;// Apply search filter\nif(searchTerm){filtered=filtered.filter(user=>user.user_id.toLowerCase().includes(searchTerm.toLowerCase())||user.device_name&&user.device_name.toLowerCase().includes(searchTerm.toLowerCase()));}// Apply status filter\nif(statusFilter!=='all'){filtered=filtered.filter(user=>user.status===statusFilter);}return filtered;},[users,searchTerm,statusFilter]);const getStatusBadge=status=>{switch(status){case'listening':return/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-listening\",children:\"\\uD83C\\uDFA7 Listening\"});case'idle':return/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-idle\",children:\"\\uD83D\\uDE34 Idle\"});case'offline':return/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-offline\",children:\"\\uD83D\\uDCF5 Offline\"});default:return/*#__PURE__*/_jsx(\"span\",{className:\"status-badge status-idle\",children:\"\\u2753 Unknown\"});}};const formatLastSeen=timestamp=>{if(!timestamp)return'Never';const now=new Date();const lastSeen=new Date(timestamp);const diffMs=now-lastSeen;const diffMins=Math.floor(diffMs/60000);const diffHours=Math.floor(diffMins/60);const diffDays=Math.floor(diffHours/24);if(diffMins<1)return'Just now';if(diffMins<60)return\"\".concat(diffMins,\"m ago\");if(diffHours<24)return\"\".concat(diffHours,\"h ago\");return\"\".concat(diffDays,\"d ago\");};const handleUserAction=(user,action)=>{switch(action){case'play':onPlayAudio&&onPlayAudio(user);break;case'start':onStartListening&&onStartListening(user.user_id);break;case'stop':onStopListening&&onStopListening(user.user_id);break;default:break;}};if(loading&&users.length===0){return/*#__PURE__*/_jsxs(\"div\",{className:\"user-list-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-list-header\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83E\\uDD87 Connected Devices\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"loading-users\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading users...\"})]})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"user-list-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-list-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\uD83E\\uDD87 Connected Devices (\",filteredUsers.length,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-list-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search devices...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\"}),/*#__PURE__*/_jsx(\"span\",{className:\"search-icon\",children:\"\\uD83D\\uDD0D\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),className:\"status-filter\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Status\"}),/*#__PURE__*/_jsx(\"option\",{value:\"listening\",children:\"Listening\"}),/*#__PURE__*/_jsx(\"option\",{value:\"idle\",children:\"Idle\"}),/*#__PURE__*/_jsx(\"option\",{value:\"offline\",children:\"Offline\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"user-list\",children:filteredUsers.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-users\",children:[/*#__PURE__*/_jsx(\"p\",{children:searchTerm||statusFilter!=='all'?'ðŸ” No devices match your search criteria':'ðŸ“± No devices connected yet'}),searchTerm&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:()=>setSearchTerm(''),children:\"Clear Search\"})]}):filteredUsers.map(user=>{var _user$location,_user$location$lat,_user$location2,_user$location2$lng,_user$uploads;return/*#__PURE__*/_jsxs(\"div\",{className:\"user-card \".concat(selectedUser===user.user_id?'selected':''),onClick:()=>onUserSelect&&onUserSelect(user.user_id),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"user-id\",children:[\"\\uD83D\\uDCF1 \",user.user_id]}),/*#__PURE__*/_jsxs(\"p\",{className:\"user-location\",children:[\"\\uD83D\\uDCCD \",(_user$location=user.location)===null||_user$location===void 0?void 0:(_user$location$lat=_user$location.lat)===null||_user$location$lat===void 0?void 0:_user$location$lat.toFixed(4),\", \",(_user$location2=user.location)===null||_user$location2===void 0?void 0:(_user$location2$lng=_user$location2.lng)===null||_user$location2$lng===void 0?void 0:_user$location2$lng.toFixed(4)]})]}),getStatusBadge(user.status)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Recordings:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:((_user$uploads=user.uploads)===null||_user$uploads===void 0?void 0:_user$uploads.length)||0})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Last Seen:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:formatLastSeen(user.last_seen)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-actions\",children:[user.latest_audio&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:e=>{e.stopPropagation();handleUserAction(user,'play');},title:\"Play latest recording\",children:\"\\uD83C\\uDFB5 Play Audio\"}),user.status==='listening'?/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:e=>{e.stopPropagation();handleUserAction(user,'stop');},title:\"Stop listening\",children:\"\\u23F9\\uFE0F Stop\"}):/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:e=>{e.stopPropagation();handleUserAction(user,'start');},title:\"Start listening\",children:\"\\u25B6\\uFE0F Listen\"})]})]}),user.uploads&&user.uploads.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"user-uploads\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Recent Uploads:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-list\",children:[user.uploads.slice(0,3).map((upload,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"upload-item\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"upload-filename\",children:[\"\\uD83C\\uDFB5 \",upload.filename]}),/*#__PURE__*/_jsx(\"span\",{className:\"upload-time\",children:new Date(upload.timestamp).toLocaleTimeString()})]},index)),user.uploads.length>3&&/*#__PURE__*/_jsxs(\"p\",{className:\"more-uploads\",children:[\"+\",user.uploads.length-3,\" more recordings...\"]})]})]})]},user.user_id);})})]});};export default UserList;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}